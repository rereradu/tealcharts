<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>


        <!-- Styles -->
        <style>
            body {
                font-family: Arial, Helvetica, sans-serif;
            }
            #chartdiv {
                width: 100%;
                height: 80vh;
            }
            .score-label {
                width: 100px;
                height: 50px;
                text-align: center;
                display: flex;
                flex-direction: row;
                align-content: center;
                justify-content: space-around;
                align-items: center;
            }

            .score-label.purple {
                background-color: #7030a0;
            }
            .score-label.blue {
                background-color: #00b0f0;
            }
            .score-label.green {
                background-color: #66ff33;
            }
            .score-label.teal {
                background-color: #66ffff;
            }

            .team-goal {
                background-color: rgba(57, 100, 120, 0.5);
                width: 150px;
                height: 50px;
                text-align: center;
                display: flex;
                flex-direction: row;
                align-content: center;
                justify-content: space-around;
                align-items: center;
            }
        </style>

        <!-- Resources -->
        <script src="https://cdn.amcharts.com/lib/4/core.js"></script>
        <script src="https://cdn.amcharts.com/lib/4/charts.js"></script>
        <script src="https://cdn.amcharts.com/lib/4/themes/animated.js"></script>

    </head>
    <body>
        

        <!-- Chart code -->
        <script>
            am4core.ready(function () {
                // Themes begin
                am4core.useTheme(am4themes_animated);
                // Themes end

                // Create chart instance
                var chart = am4core.create('chartdiv', am4charts.XYChart);
               

                var scores = [
                    'purple',
                    'blue',
                    'green',
                    'teal'
                ]

                // Add data
                chart.data = [

                    {score: 'purple'},
                    {score: 'blue'},
                    {score: 'green'},
                    {score: 'teal'},
                    {
                        question: 'Q1',
                        questionArea: 'Being informed',
                        questionText: 'What information do you take most time to share and discuss together',
                        score: 'blue',
                        cluster: 'Team thinking'
                    },
                    {
                        question: 'Q2',
                        questionArea: 'Being creative',
                        questionText: 'How does the team find solutions or solve problems together',
                        score: scores[Math.floor(Math.random() * 4)],
                        cluster: 'Team thinking'
                    },
                    {
                        question: 'Q3',
                        questionArea: 'Considering alternatives',
                        questionText: 'How does the team look at options together',
                        score: scores[Math.floor(Math.random() * 4)],
                        cluster: 'Team thinking'
                    },
                    {
                        question: 'Q4',
                        questionArea: 'Listening',
                        questionText: 'What best describes your discussions in team meetings',
                        score: scores[Math.floor(Math.random() * 4)],
                        cluster: 'Team working'
                    },
                    {
                        question: 'Q5',
                        questionArea: 'Facilitating',
                        questionText: 'What best describes regular team meetings',
                        score: scores[Math.floor(Math.random() * 4)],
                        cluster: 'Team working'
                    },
                    {
                        question: 'Q6',
                        questionArea: 'Learning',
                        questionText: 'How do you learn from each other?',
                        score: scores[Math.floor(Math.random() * 4)],
                        cluster: 'Team working'
                    },
                    {
                        question: 'Q7',
                        questionArea: 'Influencing',
                        questionText: 'How do you get people on-side',
                        score: scores[Math.floor(Math.random() * 4)],
                        cluster: 'Team communicating'
                    },
                    {
                        question: 'Q8',
                        questionArea: 'Exciting',
                        questionText: 'How does the team mainly create confidence',
                        score: scores[Math.floor(Math.random() * 4)],
                        cluster: 'Team communicating'
                    },
                    {
                        question: 'Q9',
                        questionArea: 'Messaging',
                        questionText: 'Are the regular messages from the team',
                        score: scores[Math.floor(Math.random() * 4)],
                        cluster: 'Team communicating'
                    },
                    {
                        question: 'Q10',
                        questionArea: 'Delivering',
                        questionText: 'How does the team get things done',
                        score: scores[Math.floor(Math.random() * 4)],
                        cluster: 'Team actions'
                    },
                    {
                        question: 'Q11',
                        questionArea: 'Tracking',
                        questionText: 'How does the team keep things on track',
                        score: scores[Math.floor(Math.random() * 4)],
                        cluster: 'Team actions'
                    },
                    {
                        question: 'Q12',
                        questionArea: 'Making a difference',
                        questionText: 'What is the biggest difference the team makes',
                        score: scores[Math.floor(Math.random() * 4)],
                        cluster: 'Team actions'
                    },
                ];

                var a1Data = [
                    {
                        question: 'Q1',
                        questionArea: 'Being informed',
                        questionText: 'What information do you take most time to share and discuss together?',
                        respondents: 12,
                        score: 'blue',
                        answer: 'Management information',
                        cluster: 'Team thinking'
                    },
                    {
                        question: 'Q1',
                        questionArea: 'Being informed',
                        questionText: 'What information do you take most time to share and discuss together?',
                        respondents: 4,
                        score: 'purple',
                        answer: 'Urgent issues',
                        cluster: 'Team thinking'
                    },
                    {
                        question: 'Q1',
                        questionArea: 'Being informed',
                        questionText: 'What information do you take most time to share and discuss together?',
                        respondents: 8,
                        score: 'green',
                        answer: 'Technological and other industry trends',
                        cluster: 'Team thinking'
                    },
                ];

                // Create axes

                var xAxis2 = chart.xAxes.push(new am4charts.CategoryAxis());
                xAxis2.dataFields.category = "cluster";
                xAxis2.renderer.minGridDistance = 1;
                xAxis2.renderer.grid.template.location = 0;
                xAxis2.renderer.labels.template.fontSize = 20;
                xAxis2.renderer.grid.template.strokeWidth = 5;
                xAxis2.renderer.grid.template.strokeOpacity = 1;
                xAxis2.renderer.grid.template.stroke = am4core.color('#999');

                var xAxis = chart.xAxes.push(new am4charts.CategoryAxis());
                xAxis.dataFields.category = "questionArea";
                xAxis.renderer.minGridDistance = 1;
                // xAxis.renderer.grid.template.disabled = true;

                var xAxisLabel = xAxis.renderer.labels.template;
                xAxisLabel.rotation = -60;
                xAxisLabel.fontWeight = 'bold';
                xAxisLabel.horizontalCenter = "right";
                xAxisLabel.verticalCenter = "middle";
                xAxisLabel.position = -1;


                // Create value axis
                var yAxis = chart.yAxes.push(new am4charts.CategoryAxis());
                yAxis.dataFields.category = 'score';
                yAxis.renderer.grid.template.disabled = true;
                yAxis.title.text = "Team mode";
                yAxis.title.fontWeight = "bold";

                var yAxisLabel = yAxis.renderer.labels.template;
                yAxisLabel.html = ''

                yAxisLabel.adapter.add('html', function(html, target) {
                    if (target.dataItem.dataContext) {
                        var score = target.dataItem.dataContext.score;
                        return '<div class="score-label ' + score + ' "><p>Column left <br />' + score + ' score</p></div>';
                    }

                    return html;
                });

                yAxisLabel.tooltip = new am4core.Tooltip();
                var chartTooltip = yAxisLabel.tooltip;
                chartTooltip.getFillFromObject = false;
                chartTooltip.background.fill = am4core.color("#ffffff");
                chartTooltip.background.fillOpacity = 1;
                chartTooltip.background.strokeWidth = 1;
                chartTooltip.background.stroke = am4core.color("#000000")
                chartTooltip.pointerOrientation = 'left';
                chartTooltip.label.fill = am4core.color("#222222");
                chartTooltip.label.minWidth = 400;
                chartTooltip.label.maxWidth = 400;
                chartTooltip.label.wrap = true;

                yAxisLabel.tooltipHTML = '';

                yAxisLabel.adapter.add('tooltipHTML', function(html, target) {
                    if (target.dataItem.dataContext) {
                        var score = target.dataItem.dataContext.score;
                        switch (score) {
                            case 'purple':
                                return score + ' means &lt; insert explanation here &gt;';
                                break;
                            case 'blue':
                                return score + ' means &lt; insert explanation here &gt;';
                                break;
                            case 'green':
                                return score + ' means &lt; insert explanation here &gt;';
                                break;
                            case 'teal':
                                return score + ' means &lt; insert explanation here &gt;';
                                break;
                        }
                    }
                });


                var yAxis2 = chart.yAxes.push(new am4charts.CategoryAxis());
                yAxis2.dataFields.category = 'score';

                yAxis2.renderer.opposite = true;
                var yAxis2Label = yAxis2.renderer.labels.template;
                yAxis2Label.html = '';
                yAxis2Label.text = '';
                yAxis2Label.dx = -8;
                yAxis2Label.dy = -1;

                yAxis2Label.adapter.add('text', function(text, target) {
                    return '';
                });

                yAxis2Label.adapter.add('html', function(html, target) {
                    // console.log(target.dataItem);
                    if (target.dataItem.dataContext && target.dataItem.dataContext.score === 'green') {
                        var score = target.dataItem.dataContext.score;
                        return '<div class="team-goal"><p>Team Goal</p></div>';
                    } else {
                        return '';
                    }

                    return html;
                });

                yAxis2Label.tooltipHTML = '';
                yAxis2Label.tooltip = new am4core.Tooltip();
                var chartTooltip = yAxis2Label.tooltip;
                chartTooltip.getFillFromObject = false;
                chartTooltip.background.fill = am4core.color("#ffffff");
                chartTooltip.background.fillOpacity = 1;
                chartTooltip.background.strokeWidth = 1;
                chartTooltip.background.stroke = am4core.color("#000000")
                chartTooltip.pointerOrientation = 'horizontal';
                chartTooltip.label.fill = am4core.color("#222222");
                chartTooltip.label.minWidth = 400;
                chartTooltip.label.maxWidth = 400;
                chartTooltip.label.wrap = true;

                yAxis2Label.adapter.add('tooltipHTML', function(html, target) {
                    // console.log(target.dataItem);
                    if (target.dataItem.dataContext && target.dataItem.dataContext.score === 'green') {
                        var score = target.dataItem.dataContext.score;
                        return '<p>Description of the team goal goes here.</p>';
                    } else {
                        return '';
                    }

                    return html;
                });

                heatMapSeries();



                var range = yAxis.axisRanges.create();
                range.category = 'green';
                // range.value = 2;
                range.grid.stroke = am4core.color("#396478");
                range.grid.strokeWidth = 50;
                range.grid.strokeOpacity = 0.5;
                // range.label.location = 0;
                // range.label.dataItem.text = 'test';
                range.label.fillOpacity = 0;

                // Create series
                var lineSeries = chart.series.push(new am4charts.LineSeries());
                lineSeries.dataFields.categoryX = 'questionArea';
                lineSeries.dataFields.categoryY = 'score';
                lineSeries.strokeWidth = 3;
                lineSeries.strokeOpacity = 0;
                lineSeries.xAxis = xAxis;

                // Add simple bullet
                var bullet = lineSeries.bullets.push(new am4charts.CircleBullet());
                bullet.circle.radius = 20;
                bullet.circle.strokeOpacity = 0;

                bullet.adapter.add('fill', function(color, target) {
                    if (target.dataItem.dataContext) {
                        switch (target.dataItem.dataContext.score) {
                            case 'purple':
                                return am4core.color('#7030a0');
                                break;
                            case 'blue':
                                return am4core.color('#00b0f0');
                                break;
                            case 'green':
                                return am4core.color('#66ff33');
                                break;
                            case 'teal':
                                return am4core.color('#66ffff');
                                break;
                        }
                    }
                    return color;
                });





            function heatMapSeries() {
                var series = chart.series.push(new am4charts.LineSeries());
                series.data = a1Data;
                series.dataFields.categoryX = "questionArea";
                series.dataFields.categoryY = 'score';
                series.dataFields.value = "respondents";
                series.strokeOpacity = 0;
                series.name = "Series 1";
                series.xAxis = xAxis;

                var bullet2 = series.bullets.push(new am4charts.CircleBullet());
                bullet2.strokeOpacity = 0.2;
                bullet2.stroke = am4core.color("#ffffff");
                bullet2.nonScalingStroke = true;
                bullet2.tooltipText = "";
                bullet2.fillOpacity = 1;

                 bullet2.tooltip = new am4core.Tooltip();
                var chartTooltip = bullet2.tooltip;
                chartTooltip.getFillFromObject = false;
                chartTooltip.background.fill = am4core.color("#ffffff");
                chartTooltip.background.fillOpacity = 1;
                chartTooltip.background.strokeWidth = 1;
                chartTooltip.background.stroke = am4core.color("#000000")
                chartTooltip.pointerOrientation = 'left';
                chartTooltip.label.fill = am4core.color("#222222");
                chartTooltip.label.minWidth = 400;
                chartTooltip.label.maxWidth = 400;
                chartTooltip.label.wrap = true;

                bullet2.tooltipHTML = '';
                bullet2.adapter.add('tooltipHTML', function(content, target) {
                    if (target.dataItem) {
                        var questionData = target.dataItem.dataContext;
                        var content = '<div><p>Question: <strong>' + questionData.questionText + '</strong></p>';
                            content += '<p><strong>' + questionData.respondents + '</strong> respondents have answered: <strong>' + questionData.answer + '</strong><p>';
                            content += '</div>';
                    }
                    return content;
                });
                
                series.heatRules.push({
                    target: bullet2.circle,
                    min: 10,
                    max: 30,
                    property: "radius"
                });
            }

            }); // end am4core.ready()
        </script>

        <!-- HTML -->
        <div id="chartdiv"></div>
    </body>
</html>
